<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<script th:src="@{/js/gmaps.js}"></script>
<script th:src="@{/js/controles_front.js}"></script>
<link rel="stylesheet" th:href="@{/bootstrap-4.5.2-dist/css/bootstrap.min.css}" />
<link rel="stylesheet" th:href="@{/css/jquery-ui.min.css}" />
<link href="https://fonts.googleapis.com/css?family=Lobster&display=swap" rel="stylesheet">
<link rel="stylesheet"	href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
<link rel="stylesheet"	href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" />
<link rel="stylesheet" type="text/css" href="/hotel-datepicker/dist/css/hotel-datepicker.css">
<link rel="stylesheet" type="text/css" href="js/css/main.css">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBCKiIqCdZGrVxx06LSbe7uG3zXOq1Cz5k&callback=initMap" async defer></script>

<style>
ul, li {
    padding-left:0 !important;
    margin-left:0 !important;
}	

html, body {
  height: 100%;
}
 
body {
  overflow: hidden;
}
    

.map-example {
  margin-top:10px;
}

@media(min-width: 992px){
  .map-example #map{
    height: 768px;
  }
}
</style> 


</head>

<div th:replace="layout/public_layout :: navigation"></div>	

<body class="bg-light">		

<div class="p-2" >
<button type="button" class="btn btn-sm btn-primary" data-toggle="modal" data-target="#tarifaModal" th:text="#{text.mapa.tarifas}">
  Tarifas
</button>
<button type="button" class="btn btn-sm btn-primary" data-toggle="modal" data-target="#condicionesModal" th:text="#{text.mapa.condiciones}">
  Condiciones del Servicio
</button>
<button type="button" class="btn btn-sm btn-primary" data-toggle="modal" data-target="#cancelacionModal" th:text="#{text.mapa.cancelacion}">
  Politica de Cancelación
</button>

<!-- Tarifas -->
<div class="modal fade" id="tarifaModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel" th:text="#{text.mapa.tarifas}">Tarifas</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
      	<span th:each="itemPiso: ${itemPisos}">
      	<h3 th:text="${itemPiso.nombre}"></h3>
       <p th:text="#{text.mapa.tarifaBase}+' '+${itemPiso.tarifaBase}+#{text.mapa.noche}"></p>
      <div th:if="${not #lists.isEmpty(itemPiso.itemTarifas)}">
      <table class="table">
  		<caption th:text="#{text.mapa.tarifas}">Tarifas</caption>
		  <thead>
		    <tr>
		      <th scope="col" th:text="#{text.mapa.tarifa}">Tarifa</th>
		      <th scope="col" th:text="#{text.mapa.inicio}">Inicio</th>
		      <th scope="col" th:text="#{text.mapa.fin}">Fin</th>
		      <th scope="col" th:text="#{text.mapa.noche+' '+text.euro}">/noche</th>
		    </tr>
		  </thead>
		  <tbody>
		    <tr th:each="itemTarifas : ${itemPiso.itemTarifas}" >
		      <th th:text="${itemTarifas.detalle}"></th>
		      <td th:text="${itemTarifas.fechaInicio}"></td>
		      <td th:text="${itemTarifas.fechaFin}"></td>
		      <td th:text="${itemTarifas.tarifaNueva}"></td>
		    </tr>
		  </tbody>
		</table>
		</div>
        </span>
      </div>
    </div>
  </div>
</div>



<div class="map-example ">
    <div class="row">
        <div class="col-lg-6">
            <div class="border border-dark rounded" id="map"></div>
        </div>
        
        <div class="col-lg-6" style="height:768 px;">
                <h3 class="text-secondary" style="font-family: 'Lobster'">Apartamentos en Plasencia</h3>
                <p class="font-weight-light small text-secondary font-italic" th:if="${#strings.length(fecha) > 0}"><span th:text="${fecha}"></span></p>
          
            <!-- Cominezan las tarjetas -->
              <div id="Layer1" style="width:100%; height:768px; overflow-y: scroll;">
               <span th:each="miniFoto: ${miniFotos}">
					<div class="card mb-4" style="width:95%";>
							<div class="row no-gutters">
								<div class="col-md-4 ">
								<a th:href="@{'/publico/galeria_publica/'+${miniFoto.piso.id}}">
									<img th:if="${#strings.length(miniFoto.fotoImg) > 0}" class="card-img-top mt-3 p-2 shadow-sm"
										th:src="@{'/uploads/'+${miniFoto.fotoImg}}" th:alt="${miniFoto.detalle}" /></a>
								</div>
								<div class="col-md-8">
									<div class="card-body">
										<h4 class="card-title" th:text="${miniFoto.piso.nombre}"></h4>
										<div th:switch="${idioma}"> 
											<p th:case="'ES'"  th:text="${miniFoto.piso.detalle}"></p>
											<p th:case="'EN'"  th:text="${miniFoto.piso.detalleEN}"></p>
											<p th:case="'FR'"  th:text="${miniFoto.piso.detalleFR}"></p>
											<p th:case="'DE'"  th:text="${miniFoto.piso.detalleDE}"></p>
										</div>
										
										<ul class="list-group list-group-horizontal list-unstyled">
											<li class="list-group-item border-0">
											<a class="text-primary"  th:href="@{'/reservas/reserva/'+${miniFoto.piso.id}}" th:text="#{text.mapa.reservar}">Reservar </a>
											</li>
											<li class="list-group-item border-0">
											<a th:href="@{'/publico/galeria_publica/'+${miniFoto.piso.id}}"  class="text-primary"  th:text="#{text.mapa.galeria}">Galeria </a>
											</li>
											<li class="list-group-item border-0">
											<a th:href="@{/privada/form/}+${miniFoto.piso.id}" class="text-danger " sec:authorize="hasRole('ROLE_ADMIN')">Editar </a>
											</li>
											<li class="list-group-item border-0">
											<h5 class="text-right" th:text="${miniFoto.piso.tarifaBase}+'â‚¬/Noche'"> </h5>
											</li>
										</ul>
									</div>
								</div>
							</div>
						</div>
					</span>
				</div>
			</div>
		</div>
      </div>
    </div>
  </div>	
</body>	

<div th:replace="layout/layout :: modalCondiciones"></div>
	

	<script type="text/javascript" src="http://lopezb.com/hoteldatepicker/js/fecha.min.js"></script>
	<script type="text/javascript" src="http://lopezb.com/hoteldatepicker/js/hotel-datepicker.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>

	
<script th:inline="javascript">

/*<![CDATA[*/
var pisos = /*[[${itemPisos}]]*/ 'default';
/*]]>*/


var locations = [];

for(var i = 0; i < pisos.length; i++) {
	locations.push([pisos[i].nombre, pisos[i].coordenadaX, pisos[i].coordenadaY, i+1,pisos[i].detalle,pisos[i].id]);
}

 var map = new google.maps.Map(document.getElementById('map'), {
   zoom: 20,
   center: new google.maps.LatLng(40.0354505, -6.0900350),
   mapTypeId: google.maps.MapTypeId.ROADMAP
 });

 var infowindow = new google.maps.InfoWindow();

 var marker, i;

 for (i = 0; i < locations.length; i++) {  
  
	marker = new google.maps.Marker({
     position: new google.maps.LatLng(locations[i][1], locations[i][2]),
     map: map,
   });
   
   var contentString = '<div id="content">'+
   '<div id="siteNotice">'+
   '</div>'+
   '<h1 id="firstHeading" class="firstHeading">'+locations[i][0]+'</h1>'+
   '<div id="bodyContent">'+
   '<p>'+locations[i][4]+'</p>'+
   '<p><a href="/reservas/listar/'+locations[i][5]+'"">'+
   'Reservar</a> '+
   '</div>'+
   '</div>';
   
 

   google.maps.event.addListener(marker, 'click', (function(marker, i) {
     return function() {
       infowindow.setContent(contentString);
       infowindow.open(map, marker);
       
     }
   })(marker, i));
 }

 
 

	(function() {
		// ------------------- DEMO 1 ------------------- //

		var today = new Date();
		var tomorrow = new Date();
		tomorrow.setDate(tomorrow.getDate() + 1);
		var input1 = document.querySelector('#demo1-input-parent input');
		input1.value = fecha.format(today, 'YYYY-MM-DD') + ' - '
				+ fecha.format(tomorrow, 'YYYY-MM-DD');

		var demo1 = new HotelDatepicker(input1);

	})();
	


</script>

</html>